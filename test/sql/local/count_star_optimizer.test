# name: test/sql/local/count_star_optimizer.test
# description: Test count star optimizer in an iceberg scan
# group: [local]

require avro

require parquet

require iceberg

require httpfs

require-env DUCKDB_ICEBERG_HAVE_GENERATED_DATA

# use statistics information.
query II
explain SELECT count(*) FROM ICEBERG_SCAN('__WORKING_DIRECTORY__/data/generated/iceberg/spark-local/default/count_star_optimizer');
----
physical_plan	<REGEX>:.*COLUMN_DATA_SCAN.*~1.*

# contain delete file, do not use the statistics information.
query II
explain SELECT count(*) FROM ICEBERG_SCAN('__WORKING_DIRECTORY__/data/generated/iceberg/spark-local/default/count_star_optimizer_with_deletes');
----
physical_plan	<REGEX>:.*ICEBERG_SCAN.*~1.*


